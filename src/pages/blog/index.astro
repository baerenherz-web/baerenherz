---
import Layout from '@layouts/Layout.astro'
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'

import FormattedDate from '@components/FormattedDate.astro'
import Container from '@components/container.astro'

import headerImg from '@assets/blog/postheader.png'

// sort posts by date, newest first
const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
)
---

<Layout title="Blog">
  <Container class="mx-14 my-10">
    <div class="my-2 py-2">
      <Image src={headerImg} alt="header post" />
    </div>
    {
      posts.map((post) => (
        <li class="list-none">
          <a href={`/blog/${post.slug}/`}>
            <Image
              width={720}
              height={360}
              src={post.data.cover}
              alt={post.data.coverAlt}
            />
            <div class="mb-6 mt-2 pb-10 pt-4">
              <h4 class="text-3xl">{post.data.title}</h4>
              <p class="pb-4 pt-2 text-base text-gray-500">
                <FormattedDate date={post.data.pubDate} />
              </p>
              <div class="prose-base line-clamp-4 lg:prose-xl">
                {post.data.description}
              </div>
            </div>
          </a>
        </li>
      ))
    }
  </Container>
</Layout>
