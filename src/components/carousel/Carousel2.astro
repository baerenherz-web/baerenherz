---
import { getCollection } from 'astro:content'
import { Image } from 'astro:assets'

import Swipper from 'swiper/react'
import SwipperSlide from 'swiper/react'
import Pagination from 'swiper'
import 'swiper/css'
import 'swiper/css/pagination'

import FormattedDate from '@components/FormattedDate.astro'

// sort posts by date, newest first
const posts = (await getCollection('aktivitaeten')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
)
---

{
  posts.map((post, index) => (
    <Swipper pagination={{ dynamicBullets: true }} modules={[Pagination]}>
      <SwipperSlide key={index}>
        <li>
          <a href={`/aktivitaeten/${post.slug}/`}>
            <Image
              width={720}
              height={360}
              src={post.data.cover}
              alt={post.data.coverAlt}
            />
            <div class="mb-6 mt-2 pb-10 pt-4">
              <h4 class="text-3xl">{post.data.title}</h4>
              <p class="pb-4 pt-2 text-base text-gray-500">
                <FormattedDate date={post.data.pubDate} />
              </p>
              <div class="prose-base line-clamp-4 lg:prose-xl">
                {post.data.description}
              </div>
            </div>
          </a>
        </li>
      </SwipperSlide>
    </Swipper>
  ))
}
